"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[606],{7606:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var r=a(9439),i=a(2791),n=a(8890),s=a.n(n),l=a(2144),o=a(4266),c=a(3360),d=a(1933),u=a(1374),p=a(6612),h=a(7871),m=a(3433),x=a(5316),j=a(8041),y=a(5705),b=a(8007),v=a(184);var f=function(e){var t=e.data,a=(0,d.useQueryClient)(),r=(0,i.useContext)(h.H),n=r.proState,s=r.proDispatch,l=(0,d.useQuery)("suppliers",u.yn),o={id:null===t||void 0===t?void 0:t.id,name:null===t||void 0===t?void 0:t.name,price:null===t||void 0===t?void 0:t.price,quantity:null===t||void 0===t?void 0:t.quantity,supplier:null===t||void 0===t?void 0:t.supplier},p=b.Ry().shape({name:b.Z_().required("Required*"),price:b.Rx().required("Required*").min(0,"invalid price").positive("Invalid number").integer("Invalid"),quantity:b.Rx().required("Required*").min(0,"invalid price").integer("Invalid"),supplier:b.Z_().required("Required*")}),f=(0,d.useMutation)("products",u.rs,{onMutate:function(e){var t=a.getQueryData("products");return a.setQueryData("products",(function(t){return[].concat((0,m.Z)(t),[e])})),t},onSettled:function(){a.invalidateQueries("products")}}).mutateAsync;return(0,v.jsxs)(x.Z,{show:n.showProductEditModal,onHide:function(){return s({type:"showProductEditModal",payload:!1})},children:[(0,v.jsx)(x.Z.Header,{children:(0,v.jsx)(x.Z.Title,{children:"Edit Product"})}),(0,v.jsx)(y.J9,{initialValues:o,validationSchema:p,onSubmit:function(e,t){f(e,{onSuccess:function(){t.setSubmitting(!1),alert("Changes Saved"),s({type:"showProductEditModal",payload:!1})}})},enableReinitialize:!0,children:function(e){var t,a=e.handleChange,r=e.handleSubmit,i=e.errors,n=e.isSubmitting,o=e.touched,d=e.values;return(0,v.jsxs)(j.Z,{className:"py-4",children:[(0,v.jsxs)(x.Z.Body,{className:"p-4",children:[(0,v.jsx)(j.Z.Control,{type:"hidden",name:"id",value:d.id,onChange:a("id")}),(0,v.jsxs)(j.Z.Group,{className:"pb-3",controlId:"productName",children:[(0,v.jsx)(j.Z.Label,{children:"Name"}),(0,v.jsx)(j.Z.Control,{type:"text",placeholder:"Enter product name",name:"name",value:d.name,onChange:a("name")}),o.name&&i.name?(0,v.jsx)(j.Z.Text,{className:"text-danger",children:i.name}):null]}),(0,v.jsxs)(j.Z.Group,{className:"pb-3",controlId:"productPrice",children:[(0,v.jsx)(j.Z.Label,{children:"Price (GH\xa2)"}),(0,v.jsx)(j.Z.Control,{type:"text",placeholder:"Enter price",name:"price",value:d.price,onChange:a("price"),onError:function(e){return alert(e)}}),o.price&&i.price?(0,v.jsx)(j.Z.Text,{className:"text-danger",children:i.price}):null]}),(0,v.jsxs)(j.Z.Group,{className:"pb-3",controlId:"productName",children:[(0,v.jsx)(j.Z.Label,{children:"Quantity"}),(0,v.jsx)(j.Z.Control,{type:"text",placeholder:"Enter quantity",name:"quantity",value:d.quantity,onChange:a("quantity")}),o.quantity&&i.quantity?(0,v.jsx)(j.Z.Text,{className:"text-danger",children:i.quantity}):null]}),(0,v.jsxs)(j.Z.Group,{className:"pb-3",controlId:"exampleForm.ControlSelect1",children:[(0,v.jsx)(j.Z.Label,{children:"Suppliers"}),(0,v.jsxs)(j.Z.Control,{as:"select",value:d.supplier,onChange:a("supplier"),children:[(0,v.jsx)("option",{children:"Select supplier..."}),null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.map((function(e,t){return(0,v.jsx)("option",{value:e.name,children:e.name},t+1)}))]}),o.supplier&&i.supplier?(0,v.jsx)(j.Z.Text,{className:"text-danger",children:i.supplier}):null]})]}),(0,v.jsxs)(x.Z.Footer,{children:[(0,v.jsx)(c.Z,{style:{background:"#e2ad0e",borderColor:"#e2ad0e"},variant:"dark",type:"submit",onClick:r,disabled:n,children:n?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{children:"Please Wait... "}),(0,v.jsx)("span",{className:"spinner-border spinner-border-sm"})]}):"Save Changes"}),(0,v.jsx)(c.Z,{variant:"light",onClick:function(){return s({type:"showProductEditModal",payload:!1})},children:"Cancel"})]})]})}})]})},Z=a(7689),g=a(1413);var N=function(e){var t=e.product,a=e.setProViewData;return(0,v.jsxs)(x.Z,{as:"div",keyboard:!0,animation:!0,show:t.visible,onHide:function(e){return a((0,g.Z)((0,g.Z)({},e),{},{visible:!1}))},children:[(0,v.jsx)(x.Z.Header,{closeButton:!0,children:(0,v.jsx)(x.Z.Title,{children:" Product Details"})}),(0,v.jsxs)(x.Z.Body,{children:[(0,v.jsx)("p",{className:"fw-bold text-primary",children:"Name "}),(0,v.jsx)("p",{className:"lead",children:t.name}),(0,v.jsx)("p",{className:"fw-bold text-primary",children:"Price "}),(0,v.jsx)("p",{className:"lead",children:t.price}),(0,v.jsx)("p",{className:"fw-bold text-primary",children:"Quantity "}),(0,v.jsx)("p",{className:"lead",children:t.quantity}),(0,v.jsx)("p",{className:"fw-bold text-primary",children:"Supplier "}),(0,v.jsx)("p",{className:"lead",children:t.supplier})]})]})},C=a(71);function w(){var e=(0,Z.s0)(),t=(0,i.useRef)(null),a=(0,i.useState)(),n=(0,r.Z)(a,2),m=n[0],x=n[1],j=(0,i.useState)({visible:!1,name:"",price:"",quantity:"",supplier:""}),y=(0,r.Z)(j,2),b=y[0],g=y[1],w=(0,i.useContext)(h.H),S=w.proState,q=w.proDispatch,k=(0,d.useQueryClient)(),P=(0,d.useMutation)(u.Ir).mutateAsync,D=(0,d.useQuery)("products",u.Dg,{staleTime:15e3,cacheTime:3e3,onSuccess:function(e){q({type:"productsDetails",payload:e})},onError:function(){e("/error",{replace:!0})}});return(0,i.useEffect)((function(){s()("#".concat(t.current.id)).DataTable({scrollY:400,scrollX:!0,scrollCollapse:!0,fixedHeader:!0,bInfo:!1,scrollResize:!0,destroy:!0,responsive:!0,buttons:["pdf","excel","copy"],data:D?D.data:[],columnDefs:[{orderable:!1,className:"select-checkbox",targets:[-2]}],select:{style:"multi",selector:"td:first-child"},order:[[1,"asc"]],columns:(0,p.on)((function(e){g({visible:!0,name:e.name,price:e.price,quantity:e.quantity,supplier:e.supplier})}),(function(e){x(e),q({type:"showProductEditModal",payload:!0})}),(function(e){P(e,{onSuccess:function(e){alert("Data Deleted"),k.invalidateQueries("products")}})}))})}),[D,k,P,q]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(l.Z,{className:"shadow",children:[(0,v.jsxs)(l.Z.Header,{className:"d-flex align-items-center justify-content-between text-dark flex-wrap",children:[(0,v.jsxs)(o.Z,{direction:"horizontal",className:"products-details-container pt-3",gap:4,children:[(0,v.jsxs)("p",{className:"position-relative me-3  ",children:["Products",(0,v.jsx)("span",{className:"bg-success text-white position-absolute right-0 bottom-50 badge badge-primary p-2 ",children:S.noOfProduct})]}),(0,v.jsxs)("p",{className:"position-relative me-3",children:["Low Stock",(0,v.jsx)("span",{className:"bg-dark text-white position-absolute right-0 bottom-50 badge badge-primary p-2",children:S.lowStock})]}),(0,v.jsxs)("p",{className:"position-relative me-3",children:["Out of Stock",(0,v.jsx)("span",{className:"bg-danger text-white position-absolute right-0 bottom-50 badge badge-primary p-2 ",children:S.outOfStock})]})]}),(0,v.jsxs)(c.Z,{className:"rounded-1",variant:"primary",onClick:function(){return q({type:"showProductModal",payload:!0})},children:[(0,v.jsx)(C.RWZ,{}),"Create New"]})]}),(0,v.jsx)(l.Z.Body,{className:"p-sm-2 p-md-4",children:(0,v.jsxs)("table",{width:"100%",id:"product-table",ref:t,className:"table table-sm table-responsive table-hover table bordered",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"Id"}),(0,v.jsx)("th",{children:"Name"}),(0,v.jsx)("th",{children:"Price"}),(0,v.jsx)("th",{children:"Quantity"}),(0,v.jsx)("th",{children:"Supplier"}),(0,v.jsx)("th",{children:"Action"})]})}),(0,v.jsx)("tbody",{})]})})]}),(0,v.jsx)(N,{product:b,setProViewData:g}),(0,v.jsx)(f,{data:m})]})}var S=i.memo(w)}}]);
//# sourceMappingURL=606.2b66ce48.chunk.js.map